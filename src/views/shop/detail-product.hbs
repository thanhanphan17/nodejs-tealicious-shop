<html lang='zxx'>

<head>
    <meta charset='UTF-8' />
    <meta name='description' content='WanderStay' />
    <meta name='keywords' content='unica, creative' />
    <meta name='viewport' content='width=device-width, initial-scale=1.0' />
    <meta http-equiv='X-UA-Compatible' content='ie=edge' />
    <title>Yên Trà Quán</title>

    <!-- Google Font -->
    <link href='https://fonts.googleapis.com/css?family=Lora:400,700&display=swap' rel='stylesheet' />
    <link href='https://fonts.googleapis.com/css?family=Cabin:400,500,600,700&display=swap' rel='stylesheet' />

    <!-- Css Styles -->
    <link rel='stylesheet' href='/css/bootstrap.min.css' type='text/css' />
    <link rel='stylesheet' href='/css/font-awesome.min.css' type='text/css' />
    <link rel='stylesheet' href='/css/elegant-icons.css' type='text/css' />
    <link rel='stylesheet' href='/css/flaticon.css' type='text/css' />
    <link rel='stylesheet' href='/css/owl.carousel.min.css' type='text/css' />
    <link rel='stylesheet' href='/css/nice-select.css' type='text/css' />
    <link rel='stylesheet' href='/css/jquery-ui.min.css' type='text/css' />
    <link rel='stylesheet' href='/css/magnific-popup.css' type='text/css' />
    <link rel='stylesheet' href='/css/slicknav.min.css' type='text/css' />
    <link rel='stylesheet' href='/css/style.css' type='text/css' />
    <style>
        * {
            box-sizing: border-box;
            padding: 0;
            margin: 0;
            outline: 0;
            direction: ltr;
        }


        .ava-modal {
            position: fixed;
            top: 0;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: rgba(0, 0, 0, 0.85);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .ava-modal>* {
            box-sizing: border-box;
        }

        .ava-alert {
            background-color: white;
            width: 80%;
            text-align: right;
            font-family: "Gill Sans", "Gill Sans MT", Calibri;
            font-weight: 900;
            animation: 25s 1 ava_alert_animation;
            -webkit-animation: 0.5s 1 ava_alert_animation;
        }

        @media (min-width: 650px) {
            .ava-alert {
                width: 300px;
            }
        }

        @keyframes ava_alert_animation {
            from {
                transform: scale(0.5);
            }

            50% {
                transform: scale(1.1);
            }

            to {
                transform: scale(1);
            }
        }

        .ava-alert .ava-progress-bar {
            position: absolute;
            left: 0;
            right: 0;
            top: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.04);
            animation-name: progressBarAnimation;
            -webkit-animation-name: progressBarAnimation;
        }

        .ava-alert .ava-text-con {
            position: relative;
        }

        @keyframes progressBarAnimation {
            from {
                width: 0%;
            }

            to {
                width: 100%;
            }
        }

        .ava-alert__icon {
            padding: 0px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            box-shadow: inset 0px -5px 7px rgba(0, 0, 0, 0.3);
        }

        .ava-alert__text {
            padding: 15px;
            line-height: 1.5em;
            color: #8a8a8a;
            font-size: 13px;
        }

        .ava-alert__btn {
            width: 70px;
            padding: 7px 0px;
            display: block;
            margin: auto;
            margin-bottom: 13px;
            border-radius: 0;
            border: 0;
            background-color: #dfdfdf;
            color: #b1b1b1;
            cursor: pointer;
            position: relative;
        }

        .ava-toast {
            position: fixed;
            box-shadow: 0px 5px 7px rgba(0, 0, 0, 0.1);
            width: 250px;
            display: flex;
            flex-direction: row;
            background-color: white;
        }

        .ava-toast svg {
            width: 30px;
            height: 30px;
        }

        .ava-toast .ava-alert__icon {
            padding: 0 10px;
            box-shadow: none;
        }

        .ava-toast .ava-text-con {
            width: 100%;
        }

        .ava-toast .ava-alert__btn {
            margin: 0;
        }

        .ava-toast .ava-alert__text {
            padding: 5px;
            width: 100%;
        }

        .svg-box {
            display: inline-block;
            position: relative;
            width: 150px;
        }

        .ava-text-con {
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            align-items: center;
        }

        .green-stroke {
            stroke: #ffffff;
        }

        .red-stroke {
            stroke: #ffffff;
        }

        .yellow-stroke {
            stroke: #ffffff;
        }

        .circular circle.path {
            stroke-dasharray: 330;
            stroke-dashoffset: 0;
            stroke-linecap: round;
            opacity: 0.4;
            animation: 0.7s draw-circle ease-out;
        }

        /*------- Checkmark ---------*/
        .checkmark {
            stroke-width: 6.25;
            stroke-linecap: round;
            position: absolute;
            top: 56px;
            left: 49px;
            width: 52px;
            height: 40px;
        }

        .checkmark path {
            animation: 1s draw-check ease-out;
        }

        @keyframes draw-circle {
            0% {
                stroke-dasharray: 0, 330;
                stroke-dashoffset: 0;
                opacity: 1;
            }

            80% {
                stroke-dasharray: 330, 330;
                stroke-dashoffset: 0;
                opacity: 1;
            }

            100% {
                opacity: 0.4;
            }
        }

        @keyframes draw-check {
            0% {
                stroke-dasharray: 49, 80;
                stroke-dashoffset: 48;
                opacity: 0;
            }

            50% {
                stroke-dasharray: 49, 80;
                stroke-dashoffset: 48;
                opacity: 1;
            }

            100% {
                stroke-dasharray: 130, 80;
                stroke-dashoffset: 48;
            }
        }

        /*---------- Cross ----------*/
        .cross {
            stroke-width: 6.25;
            stroke-linecap: round;
            position: absolute;
            top: 54px;
            left: 54px;
            width: 40px;
            height: 40px;
        }

        .cross .first-line {
            animation: 0.7s draw-first-line ease-out;
        }

        .cross .second-line {
            animation: 0.7s draw-second-line ease-out;
        }

        @keyframes draw-first-line {
            0% {
                stroke-dasharray: 0, 56;
                stroke-dashoffset: 0;
            }

            50% {
                stroke-dasharray: 0, 56;
                stroke-dashoffset: 0;
            }

            100% {
                stroke-dasharray: 56, 330;
                stroke-dashoffset: 0;
            }
        }

        @keyframes draw-second-line {
            0% {
                stroke-dasharray: 0, 55;
                stroke-dashoffset: 1;
            }

            50% {
                stroke-dasharray: 0, 55;
                stroke-dashoffset: 1;
            }

            100% {
                stroke-dasharray: 55, 0;
                stroke-dashoffset: 70;
            }
        }

        .alert-sign {
            stroke-width: 6.25;
            stroke-linecap: round;
            position: absolute;
            top: 40px;
            left: 68px;
            width: 15px;
            height: 70px;
            animation: 0.5s alert-sign-bounce cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .alert-sign .dot {
            stroke: none;
            fill: #ffffff;
        }

        @keyframes alert-sign-bounce {
            0% {
                transform: scale(0);
                opacity: 0;
            }

            50% {
                transform: scale(0);
                opacity: 1;
            }

            100% {
                transform: scale(1);
            }
        }
    </style>
</head>

<body>
    <!-- Page Preloder -->
    <div id='preloder'>
        <div class='loader'></div>
    </div>

    <!-- Header Section Begin -->
    <header class='header-section header-normal'>
        <div class='top-nav'>
            <div class='container'>
                <div class='row'>
                    <div class='col-lg-6'></div>
                </div>
            </div>
        </div>
        <div class='menu-item'>
            <div class='container'>
                <div class='row'>
                    <div class='col-lg-2'>
                        <div class='logo'>
                            <a href='/'>
                                <img src='/img/logo.png' alt='' />
                            </a>
                        </div>
                    </div>
                    <div class='col-lg-10'>
                        <div class='nav-menu'>
                            <nav class='mainmenu'>
                                <ul>
                                    <li><a href='/'>Trang chủ</a></li>
                                    <li><a href='/about-us'>Về chúng tôi</a></li>
                                    <li class='active'>
                                        <a href='/pages?page=0'>Sản phẩm</a>
                                        <ul class='dropdown'>
                                            <li><a href='/phong-vi-yen-tra'>Phong Vị Yên Trà</a></li>
                                            <li><a href='/hoa-co-duong-tam'>Hoa Cỏ Dưỡng Tâm</a></li>
                                            <li><a href='/thao-moc-nhiet-doi'>Thảo Mộc Nhiệt Đới</a></li>
                                            <li><a href='/yen-an-ngu-tra'>Yên An Ngự Trà</a></li>
                                        </ul>
                                    </li>
                                    <li><a href='/contact'>Liên hệ</a></li>
                                    <li>
                                        <a href='/cart' style='color: #0650c2'><img href='/cart'
                                                style='color: #333333; width: 20px; ' src='/img/cart-shopping.svg'
                                                alt='' /></a>
                                    </li>
                                    {{#if isLoggedIn}}
                                    <li>
                                        <img style='color: #333333; width: 20px; ' src='/img/user-profile.svg' alt='' />
                                        {{customerName}}
                                        <ul class='dropdown'>
                                            <li><a href='/profile'><img style='width: 20px' src='/img/user.png' />
                                                    Trang cá nhân</a></li>
                                            <li><a href='/change-password'><img style='width: 20px'
                                                        src='/img/key.svg' />
                                                    Đổi mật khẩu</a></li>
                                            <li><a href='/logout'><img style='width: 20px' src='/img/log-out.svg' />
                                                    Đăng xuất</a></li>
                                        </ul>
                                    </li>
                                    {{else}}
                                    <li><a href='/login' style='color: #0650c2'>Đăng nhập</a></li>
                                    <li><a href='/sign-up' style='color: #0650c2'>Tạo tài khoản</a></li>
                                    {{/if}}
                                </ul>
                            </nav>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>
    <!-- Header End -->

    <!-- Product Details Section Begin -->
    <section class='product-details spad-2'>
        <div class='container'>
            <div class='row'>
                <div class='col-lg-5 col-md-6'>
                    <div id='product-carousel' class='carousel slide' data-ride='carousel'>
                        <div class='carousel-inner border'>
                            <div class='carousel-item active'>
                                <img style='width: 100%' id="productUrl" src={{product.product.image.url.[1]}}
                                    alt='Image' />
                            </div>
                            {{#each product.product.image.url}}
                            <div class='carousel-item'>
                                <img style='width: 100%' src={{this}} alt='Image' />
                            </div>
                            {{/each}}
                        </div>
                        <a class='carousel-control-prev' href='#product-carousel' data-slide='prev'>
                            <i class='fa fa-2x fa-angle-left text-dark'></i>
                        </a>
                        <a class='carousel-control-next' href='#product-carousel' data-slide='next'>
                            <i class='fa fa-2x fa-angle-right text-dark'></i>
                        </a>
                    </div>

                </div>

                <div class='col-lg-7 col-md-6'>
                    <div class='product__details__text'>
                        <h2 class='font-weight-semi-bold' id="productName"><strong>{{product.product.name}}</strong>
                        </h2>
                        <div>
                            <br />
                            <h3 class='font-weight-semi-bold mb-4' id="productPrice">Giá: {{product.product.price}} VNĐ
                            </h3>
                        </div>
                        <p><b>Mô tả:</b>
                            {{product.product.description}}</p>

                        <div class='row'>

                            <div style='margin-left: 15px' class='center-submit'>
                                <strong class='product-price'>Số lượng</strong>
                            </div>
                            <div class='col-md-2 mb-3 mb-md-0'>
                                <input style='text-align: center;' type='text' class='form-control py-3'
                                    id='productQuantity' name="quantityInput" value='1' />
                            </div>
                            <div class='col-md-6'>
                                <input type="hidden" name="quantity" id="quantity" value=>
                                <input type="hidden" name="currentQuantity" id="currentQuantity"
                                    value={{product.product.quantity}}>
                                <input type="hidden" name="productId" id="productIdInput" value={{product.product.id}}>
                                <button style='color:#333333, width=400' class='btn btn-primary px-3'
                                    onclick="addToCart()">
                                    <i class='fa fa-shopping-cart mr-1'></i> Thêm vào giỏ hàng
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class='product-details spad'>
        <div class="container">
            <div class='row'>
                <div class='col-md-12'>
                    <div class='row px-xl-5'>
                        <div class='col'>
                            <div class='nav nav-tabs justify-content-center border-secondary mb-4'>
                                <a class='nav-item nav-link active' data-toggle='tab' href='#tab-pane-1'>
                                    <div style='text-align: center;' class='section-title'>
                                        <span>Mô tả sản phẩm</span>
                                    </div>
                                </a>
                                <a class='nav-item nav-link' data-toggle='tab' href='#tab-pane-2'>
                                    <div style='text-align: center;' class='section-title'>
                                        <span>Đổi trả - Công dụng</span>
                                    </div>
                                </a>
                                <a class='nav-item nav-link' data-toggle='tab' href='#tab-pane-3'>
                                    <div style='text-align: center;' class='section-title'>
                                        <span>Đánh giá sản phẩm</span>
                                    </div>
                                </a>
                            </div>
                            <div class='tab-content'>

                                <div class='tab-pane fade show active' id='tab-pane-1'>
                                    <div class="row">
                                        <div class="col">
                                            <h4 class='mb-3'>Mô tả sản phẩm</h4>
                                            <p>
                                                Yên Trà Quán chuyên cung cấp các sản phẩm chăm sóc sắc đẹp và sức khỏe
                                                có
                                                thành
                                                phần từ thiên nhiên với công nghệ sản xuất khác biệt, trong đó có thể kể
                                                đến
                                                các
                                                sản phẩm như trà dưỡng tâm an thần, trà gừng đường nâu thảo mộc, trà
                                                dưỡng
                                                nhan,
                                                trà gạo lứt đậu đen, bột cần tây nguyên chất, bột củ sen ngũ cốc dinh
                                                dưỡng,…xuất xứ tự nhiên không chứa chất bảo quản, không hóa chất độc hại
                                                và
                                                rất
                                                lành tính.
                                                <br />
                                                Những nguyên liệu của Yên Trà Quán đều được tuyển chọn kỹ càng để có thể
                                                mang
                                                đến cho khách hàng trải những trải nghiệm tốt nhất!
                                                <br />
                                                ❖ Thương hiệu: Yên Trà Quán
                                                <br />
                                                ❖ Xuất xứ: Việt Nam
                                                <br />
                                                ❖ Định dạng: túi
                                                <br />
                                                ❖ Hạn sử dụng: 6 tháng
                                            </p>
                                        </div>
                                    </div>

                                </div>

                                <div class='tab-pane fade' id='tab-pane-2'>
                                    <div class="row">
                                        <div class="col">
                                            <div class='row'>
                                                <div class='col-md-6'>
                                                    <h4 class='mb-3'>Quy định đổi trả hàng</h4>

                                                    <ul class='list-group list-group-flush'>
                                                        <li class='list-group-item px-0'>
                                                            ❶ Điều kiện áp dụng (trong vòng 07 ngày kể từ
                                                            khi nhận sản phẩm) <br>
                                                            – Hàng hoá vẫn còn mới, chưa qua sử dụng<br>
                                                            – Hàng hoá bị lỗi hoặc hư hỏng do vận chuyển
                                                            hoặc do nhà sản xuất
                                                        </li>
                                                        <li class='list-group-item px-0'>
                                                            ❷ Trường hợp được chấp nhận<br>
                                                            – Hàng không đúng loại như quý khách đặt hàng<br>
                                                            – Không đủ số lượng như trong đơn hàng
                                                        </li>
                                                        <li class='list-group-item px-0'>
                                                            ❸ Trường hợp không đủ điều kiện áp dụng chính
                                                            sách<br>
                                                            – Quá 07 ngày kể từ khi Quý khách nhận hàng<br>
                                                            – Gửi lại hàng không đúng mẫu mã, không phải sản
                                                            phẩm của Yên Trà Quán
                                                        </li>
                                                    </ul>
                                                </div>
                                                <div class='col-md-6'>
                                                    <h4 class='mb-3'>Công dụng sản phẩm</h4>

                                                    <ul class='list-group list-group-flush'>
                                                        <li class='list-group-item px-0'>
                                                            Mộc Liên trà mang lại cảm giác thư thái, ngăn ngừa da bị lão
                                                            hóa,
                                                            sạm nám.
                                                        </li>
                                                        <li class='list-group-item px-0'>
                                                            Mộc Liên trà hỗ trợ điều trị thiếu máu, cải thiện giấc ngủ,
                                                            cải
                                                            thiện sức khỏe từ bên trong.
                                                        </li>
                                                        <li class='list-group-item px-0'>
                                                            Mộc Liên trà giúp tăng sức đề kháng, giảm béo, cải thiện
                                                            tuần
                                                            hoàn,
                                                            làm giảm các nguy cơ tắc nghẽn mạch
                                                        </li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class='tab-pane fade' id='tab-pane-3'>
                                    <div class='row'>
                                        <div class='col'>
                                            <div class="row">
                                                <div class='col-6'>
                                                    <div id="ratingsContainer">
                                                    </div>
                                                    <div class="review-list">
                                                        {{#each rating}}
                                                        <div class='media mb-4'>
                                                            <img src='/img/profile.jpg' alt='Image'
                                                                class='img-fluid mr-3 mt-1' style='width: 45px' />
                                                            <div class='media-body'>
                                                                <h6>
                                                                    {{this.user.name}}<small> -
                                                                        <i>{{this.createdAt}}</i></small>
                                                                </h6>
                                                                <div class='product__details__rating'
                                                                    data-value="{{this.rating}}">
                                                                </div>
                                                                <p>
                                                                    {{this.comment}}
                                                                </p>
                                                            </div>
                                                        </div>
                                                        {{/each}}
                                                    </div>
                                                    <div class="col-12 pb-1">
                                                        <nav aria-label="Page navigation">
                                                            <ul class="pagination justify-content-center mb-3"
                                                                id="pagination">
                                                                <li class="page-item disabled">
                                                                    <a class="page-link" href="#" aria-label="Previous">
                                                                        <span aria-hidden="true">&laquo;</span>
                                                                        <span class="sr-only">Previous</span>
                                                                    </a>
                                                                </li>
                                                                <li class="page-item"><a class="page-link"
                                                                        onclick="loadReviewPaging(0)">1</a></li>
                                                                <li class="page-item"><a class="page-link"
                                                                        onclick="loadReviewPaging(1)">2</a></li>
                                                                {{!-- <li class="page-item"><a class="page-link"
                                                                        href="/pages?page=2">3</a></li>
                                                                <li class="page-item"><a class="page-link"
                                                                        href="/pages?page=3">4</a></li>
                                                                <li class="page-item"><a class="page-link"
                                                                        href="/pages?page=4">5</a></li>
                                                                <li class="page-item"><a class="page-link"
                                                                        href="/pages?page=5">6</a></li>
                                                                <li class="page-item"><a class="page-link"
                                                                        href="/pages?page=6">7</a></li>
                                                                <li class="page-item"><a class="page-link"
                                                                        href="/pages?page=7">8</a></li>
                                                                <li class="page-item"><a class="page-link"
                                                                        href="/pages?page=8">9</a></li> --}}
                                                                <li class="page-item">
                                                                    <a class="page-link" href="#" aria-label="Next">
                                                                        <span aria-hidden="true">&raquo;</span>
                                                                        <span class="sr-only">Next</span>
                                                                    </a>
                                                                </li>
                                                            </ul>
                                                        </nav>
                                                    </div>
                                                </div>
                                                <div class="col-6">
                                                    <h4 class='mb-4'>Đánh giá sản phẩm</h4>
                                                    <form id="ratingForm">
                                                        <div class='form-group'>
                                                            <input type="hidden" name="productId" id="productIdInput"
                                                                value={{product.product.id}}>
                                                            <label for='email'>Đánh giá sản phẩm *</label>
                                                            <div style='margin-left: 5px' class='row'>
                                                                <span class="star-rating">
                                                                    <input type="radio" name="rating" value="1"><i></i>
                                                                    <input type="radio" name="rating" value="2"><i></i>
                                                                    <input type="radio" name="rating" value="3"><i></i>
                                                                    <input type="radio" name="rating" value="4"><i></i>
                                                                    <input type="radio" name="rating" value="5"><i></i>
                                                                </span>
                                                            </div>
                                                        </div>
                                                        <div class='form-group'>
                                                            <label for='message'>Bình luận của bạn *</label>
                                                            <textarea id='message' cols='20' rows='2'
                                                                class='form-control' name="comment"></textarea>
                                                        </div>

                                                        <button id="myButton" type="button"
                                                            class="btn btn-primary-hover-outline">Gửi đánh giá</button>
                                                    </form>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class='product-section spad'>
        <div class='container'>
            <div class='row center-submit'>
                <div class='section-title'>
                    <span>Sản phẩm liên quan</span>
                </div>
            </div>
            <div class='row'>
                <div class='col-lg-12'>
                    <div class='section-title'>
                        <h2>Có thể bạn sẽ thích</h2>
                    </div>
                </div>
            </div>

            <div style='padding: 10px' class='row'>
                {{#each product.relatedProducts}}
                <div class='col-12 col-md-4 col-lg-3 mb-5 mb-md-0'>
                    <a class='product-item' href='/detail-product'>
                        <img src={{this.image.url.[0]}} class='img-fluid product-thumbnail' />
                        <h3 class='product-title'>{{this.name}}</h3>
                        <strong class='product-price'>{{this.price}} VNĐ</strong>

                        <span class='icon-cross'>
                            <img src='/img/cross.svg' class='img-fluid' />
                        </span>
                    </a>
                </div>
                {{/each}}
            </div>
        </div>
    </section>

    <!-- Product Details Section End -->
    <!-- Footer Section Begin -->
    <footer class='footer-section'>
        <div class='container'>
            <div class='footer-text'>
                <div class='row'>
                    <div class='col-lg-4'>
                        <div class='ft-about'>
                            <div class='logo'>
                                <a href='#'>
                                    <img class='img-logo' src='/img/logo.png' alt='' />
                                </a>
                            </div>
                            <p>
                                Yên Trà Quán với những tâm hồn tự tại đã trót yêu mẹ thiên nhiên say đắm, mong muốn
                                được dùng các loại thảo mộc chữa lành cho tất cả mọi người.
                            </p>
                        </div>
                    </div>
                    <div class='col-lg-3 offset-lg-1'>
                        <div class='ft-contact'>
                            <h6>Liên hệ</h6>
                            <ul>
                                <li>0123456789</li>
                                <li>yentraquan@gmail.com</li>
                                <li>227 Nguyen Van Cuu, Ward 4, <br />District 5, HCMc</li>
                            </ul>
                        </div>
                    </div>
                    <div class='col-lg-3 offset-lg-1'>
                        <div class='ft-newslatter'>
                            <h6>Thông tin mới nhất</h6>
                            <p>Cập nhật những ưu đãi và thông tin mới.</p>
                            <form action='#' class='fn-form'>
                                <input type='text' placeholder='Email' />
                                <button type='submit'><i class='fa fa-send'></i></button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class='copyright-option'>
            <div class='container'>
                <div class='row'>
                    <div class='col-lg-12'>
                        <ul>
                            <li><a href='#'>Chính sách bán hàng</a></li>
                            <li><a href='#'>Chính sách thanh toán</a></li>
                            <li><a href='#'>Chính sách bảo hành</a></li>
                            <li><a href='#'>Điều khoản dịch vụ</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </footer>
    <!-- Footer Section End -->

    <!-- Js Plugins -->
    <script src='/js/jquery-3.3.1.min.js'></script>
    <script src='/js/bootstrap.min.js'></script>
    <script src='/js/jquery.magnific-popup.min.js'></script>
    <script src='/js/jquery.nice-select.min.js'></script>
    <script src='/js/jquery-ui.min.js'></script>
    <script src='/js/jquery.slicknav.js'></script>
    <script src='/js/owl.carousel.min.js'></script>
    <script src='/js/main.js'></script>
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

    <script>
        let ava
        document.addEventListener('DOMContentLoaded', async function () {
            ava = ({ icon = 'success', toast = false, progressBar = true, text = null, timer = 4000, btnText = 'Okay', direction = 'rtl', position = 'top-right' }) => {
                const modal = document.createElement('section');
                modal.setAttribute('class', 'ava-modal');
                document.body.appendChild(modal);
                const alert = document.createElement('div');
                alert.setAttribute('class', 'ava-alert');
                modal.appendChild(alert);
                var avaIcon;
                if (icon == 'success' && toast == false) {
                    avaIcon = `
                <div class="ava-alert__icon" style="background: #438C5E;">
                <div class="svg-box">
                    <svg class="circular green-stroke">
                    <circle class="path" cx="75" cy="75" r="50" fill="none" stroke-width="5" stroke-miterlimit="10"/>
                </svg>
                <svg class="checkmark green-stroke">
                    <g transform="matrix(0.79961,8.65821e-32,8.39584e-32,0.79961,-489.57,-205.679)">
                        <path class="checkmark__check" fill="none" d="M616.306,283.025L634.087,300.805L673.361,261.53"/>
                    </g>
                </svg>
                </div>
            </div>
              `;

                } else if (icon == 'info' && toast == false) {
                    avaIcon = `
                <div class="ava-alert__icon" style="background: #434D8C;">
                <div class="svg-box">
                    <svg class="circular yellow-stroke">
                        <circle class="path" cx="75" cy="75" r="50" fill="none" stroke-width="5"
                            stroke-miterlimit="10" />
                    </svg>
                    <svg class="alert-sign yellow-stroke">
                        <g transform="matrix(1,0,0,1,-615.516,-257.346)">
                            <g transform="matrix(0.56541,-0.56541,0.56541,0.56541,93.7153,495.69)">
                                <path class="line" d="M634.087,300.805L673.361,261.53" fill="none" />
                            </g>
                            <g transform="matrix(2.27612,-2.46519e-32,0,2.27612,-792.339,-404.147)">
                                <circle class="dot" cx="621.52" cy="316.126" r="1.318" />
                            </g>
                        </g>
                    </svg>
                </div>
            </div>

              `;

                } else if (icon == 'danger' && toast == false) {
                    avaIcon = `
                <div class="ava-alert__icon" style="background: #8C4343;">
                <div class="svg-box">
                    <svg class="circular red-stroke">
                    <circle class="path" cx="75" cy="75" r="50" fill="none" stroke-width="5" stroke-miterlimit="10"/>
                </svg>
                <svg class="cross red-stroke">
                    <g transform="matrix(0.79961,8.65821e-32,8.39584e-32,0.79961,-502.652,-204.518)">
                        <path class="first-line" d="M634.087,300.805L673.361,261.53" fill="none"/>
                    </g>
                    <g transform="matrix(-1.28587e-16,-0.79961,0.79961,-1.28587e-16,-204.752,543.031)">
                        <path class="second-line" d="M634.087,300.805L673.361,261.53"/>
                    </g>
                </svg>
                </div>
            </div>
              `;

                } else if (icon == 'info' && toast == true) {
                    avaIcon = `
                    <div class="ava-alert__icon" style="background: #434D8C;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-width="2"><path stroke-dasharray="60" stroke-dashoffset="60" d="M12 3C16.9706 3 21 7.02944 21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3Z"><animate fill="freeze" attributeName="stroke-dashoffset" dur="0.5s" values="60;0"/></path><path stroke-dasharray="8" stroke-dashoffset="8" d="M12 7V13"><animate fill="freeze" attributeName="stroke-dashoffset" begin="0.6s" dur="0.2s" values="8;0"/></path></g><circle cx="12" cy="17" r="1" fill="currentColor" fill-opacity="0"><animate fill="freeze" attributeName="fill-opacity" begin="0.8s" dur="0.4s" values="0;1"/></circle></svg>
            </div>
                    `;
                    btnText = '';
                } else if (icon == 'success' && toast == true) {
                    avaIcon = `
                    <div class="ava-alert__icon" style="background: #438C5E;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path stroke-dasharray="60" stroke-dashoffset="60" d="M3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12Z"><animate fill="freeze" attributeName="stroke-dashoffset" dur="0.5s" values="60;0"/></path><path stroke-dasharray="14" stroke-dashoffset="14" d="M8 12L11 15L16 10"><animate fill="freeze" attributeName="stroke-dashoffset" begin="0.6s" dur="0.2s" values="14;0"/></path></g></svg>
            </div>
                    `;
                    btnText = '';
                } else if (icon == 'danger' && toast == true) {
                    avaIcon = `
                    <div class="ava-alert__icon" style="background: #8C4343;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-width="2"><path stroke-dasharray="60" stroke-dashoffset="60" d="M12 3C16.9706 3 21 7.02944 21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3Z"><animate fill="freeze" attributeName="stroke-dashoffset" dur="0.5s" values="60;0"/></path><path stroke-dasharray="8" stroke-dashoffset="8" d="M12 12L16 16M12 12L8 8M12 12L8 16M12 12L16 8"><animate fill="freeze" attributeName="stroke-dashoffset" begin="0.6s" dur="0.2s" values="8;0"/></path></g></svg>
            </div>
                    `;
                    btnText = '';
                } else if (toast == true && icon == 'none') {
                    avaIcon = '';
                    btnText = '';
                } else if (toast == false && icon == 'none') {
                    avaIcon = '';
                }
                document.querySelector('.ava-alert').innerHTML = `
          ${avaIcon}
<div class='ava-text-con'>
            <p class="ava-alert__text">
            ${text}
            </p>
            <button class="ava-alert__btn">${btnText}</button>
        </div>
            `;
                var new_timer_format = '';
                switch (timer) {
                    case 1000:
                        new_timer_format = '1s';
                        break;
                    case 2000:
                        new_timer_format = '2s';
                        break;
                    case 3000:
                        new_timer_format = '3s';
                        break;
                    case 4000:
                        new_timer_format = '4s';
                        break;
                    case 5000:
                        new_timer_format = '5s';
                        break;
                    case 6000:
                        new_timer_format = '6s';
                        break;
                    case 7000:
                        new_timer_format = '7s';
                        break;
                    case 8000:
                        new_timer_format = '8s';
                        break;
                    case 9000:
                        new_timer_format = '9s';
                        break;
                    case 10000:
                        new_timer_format = '10s';
                        break;
                    default:
                        new_timer_format = '4s';
                }
                if (timer > 10000) {
                    timer = 4000;
                }
                if (toast == true) {
                    modal.style = 'background-color: rgba(0, 0, 0, 0);';
                    alert.classList.add('ava-toast');
                    if (progressBar == false) {
                        document.querySelector('.ava-alert__btn').remove();
                    } else {
                        document.querySelector('.ava-alert__btn').style = 'width: 100%; padding: 2px;'
                    }
                    switch (position) {
                        case 'top-right':
                            alert.style = `
                    top: 10px;
                    right: 10px;
                    `;
                            break;
                        case 'top-left':
                            alert.style = `
                    top: 10px;
                    left: 10px;
                    `;
                            break;
                        case 'bottom-left':
                            alert.style = `
                        bottom: 10px;
                        left: 10px;
                    `;
                            break;
                        case 'bottom-right':
                            alert.style = `
                        bottom: 10px;
                    right: 10px;
                    `;
                            break;
                    }
                }
                if (progressBar == true) {
                    const progressBar_el = document.createElement('div');
                    progressBar_el.setAttribute('class', 'ava-progress-bar');
                    document.querySelector('.ava-alert__btn').appendChild(progressBar_el);
                    document.querySelector('.ava-progress-bar').style = `
                animation-duration: ${new_timer_format};
        -webkit-animation-duration: ${new_timer_format};
                `;
                }

                if (progressBar == true) {
                    setTimeout(() => {
                        modal.remove();
                        alert.remove();
                    }, timer);
                } else if (progressBar == false && toast == true) {
                    setTimeout(() => {
                        modal.remove();
                        alert.remove();
                    }, timer);
                }
                if (direction == 'rtl' && toast == true) {
                    document.querySelector('.ava-modal > *').style.direction = 'rtl';
                    document.querySelector('.ava-modal > *').style.textAlign = 'right';
                    document.querySelector('.ava-alert__btn').style.direction = 'rtl';
                } else if (direction == 'ltr' && toast == true) {
                    document.querySelector('.ava-modal > *').style.direction = 'ltr';
                    document.querySelector('.ava-modal > *').style.textAlign = 'left';
                    document.querySelector('.ava-alert__btn').style.direction = 'ltr';
                } else {
                    document.querySelector('.ava-modal > *').style.textAlign = 'center';
                }
                document.querySelector('.ava-alert__btn').addEventListener('click', function () {
                    alert.remove();
                    modal.remove();
                })
                window.addEventListener('click', function (e) {
                    if (e.target == document.querySelector('.ava-modal')) {
                        modal.remove();
                        alert.remove();
                    }
                })
            }
        })

        async function loadReviewPaging(page) {
            const productId = document.getElementById('productIdInput').value
            const url = `http://localhost:8080/api/rating/list?page=${page}&limit=3&productId=${productId}`
            await axios.get(url).then(response => {
                let reviewsApi = response.data.data.ratings
                const $review_list = $(".review-list");
                $review_list.html("");

                reviewsApi.forEach((review) => {
                    const html = `<div class='media mb-4'>
                                                            <img src='/img/profile.jpg' alt='Image'
                                                                class='img-fluid mr-3 mt-1' style='width: 45px' />
                                                            <div class='media-body'>
                                                                <h6>
                                                                    ${review.user.name}<small> -
                                                                        <i>${review.createdAt}</i></small>
                                                                </h6>
                                                                <div class='product__details__rating'
                                                                    data-value="${review.rating}">
                                                                </div>
                                                                <p>
                                                                    ${review.comment}
                                                                </p>
                                                            </div>
                                                        </div>`
                    $review_list.append($.parseHTML(html));
                })
            })
        }


        $(document).ready(function () {
            $('#myButton').on('click', function () {
                updateDOMWithRatings();
                submitForm()
            });

            var lastActiveIndex = sessionStorage.getItem('lastActiveIndex');

            if (lastActiveIndex !== null) {
                $('#pagination li.page-item').eq(lastActiveIndex).addClass('active');
            }

            $('#pagination li.page-item:not(.disabled) a').on('click', function (event) {
                $('#pagination li.page-item').removeClass('active');

                $(this).parent().addClass('active');

                var clickedIndex = $('#pagination li.page-item').index($(this).parent());
                sessionStorage.setItem('lastActiveIndex', clickedIndex);
            });
        });

        async function addToCart() {
            var quantity = document.getElementById('productQuantity').value * 1
            var currentQuantity = document.getElementById('currentQuantity').value * 1
            var productId = document.getElementById('productIdInput').value;
            var productName = document.getElementById('productName').textContent;
            var productPrice = document.getElementById('productPrice').textContent.match(/\d+/) * 1;
            var productUrl = document.getElementById('productUrl').src;

            if (quantity > currentQuantity) {
                Toast_danger('Sản phẩm hết hàng!');
                return;
            }

            const accessToken = getCookie("accessToken")
            const refreshToken = getCookie("refreshToken")

            if (!accessToken && !refreshToken) {
                let cartCookie = getArrayCookie('cartCookie')
                if (!cartCookie) {
                    const product = {
                        productId: productId,
                        quantity: quantity,
                        product: {
                            name: productName,
                            price: productPrice,
                            image: {
                                url: [
                                    productUrl]
                            }
                        }

                    }
                    cartCookie = []
                    cartCookie.push(product)
                    setArrayCookie('cartCookie', cartCookie)
                } else {
                    for (var i = 0; i < cartCookie.length; i++) {
                        if (cartCookie[i].productId == productId) {
                            Toast_danger('Sản phẩm đã có trong giỏ hàng!');
                            return;
                        }
                    }
                    const product = {
                        productId: productId,
                        quantity: quantity,
                        product: {
                            name: productName,
                            price: productPrice,
                            image: {
                                url: [
                                    productUrl]
                            }
                        }


                    }
                    cartCookie.push(product)
                    setArrayCookie('cartCookie', cartCookie)
                }
                Toast_success();
                return
            }

            const url = `http://localhost:8080/api/cart/add-to-cart`
            const headers = {
                authorization: accessToken,
                'refresh-token': refreshToken
            }

            const data = {
                productId: productId,
                quantity: quantity * 1
            }

            await axios
                .post(url, data, { headers })
                .then((response) => {
                    Toast_success();
                })
                .catch((error) => {
                    Toast_danger('Sản phẩm đã có trong giỏ hàng!');
                    console.error('Error:', error)
                })
        }

        function setArrayCookie(name, value) {
            const daysToExpire = 60;
            var expires = "";
            if (daysToExpire) {
                var date = new Date();
                date.setTime(date.getTime() + (daysToExpire * 24 * 60 * 60 * 1000));
                expires = "; expires=" + date.toUTCString();
            }

            // Convert the array or object to a string using JSON.stringify
            var serializedValue = JSON.stringify(value);

            document.cookie = name + "=" + serializedValue + expires + "; path=/";
        }

        // Function to get a cookie and parse its value as an array or object
        function getArrayCookie(name) {
            var cookieName = name + "=";
            var decodedCookie = decodeURIComponent(document.cookie);
            var cookieArray = decodedCookie.split(';');

            for (var i = 0; i < cookieArray.length; i++) {
                var cookie = cookieArray[i].trim();
                if (cookie.indexOf(cookieName) === 0) {
                    // Extract and parse the stored value using JSON.parse
                    return JSON.parse(cookie.substring(cookieName.length, cookie.length));
                }
            }

            return null;
        }

        function Toast_success() {
            ava({
                icon: 'success',
                text: 'Thêm vào giỏ hàng thành công!',
                btnText: '',
                progressBar: true,
                toast: true,
                position: 'top-right',
                direction: 'ltr',
                timer: 4000
            });
        }

        function Toast_danger(message) {
            ava({
                icon: 'danger',
                text: message,
                btnText: '',
                progressBar: true,
                toast: true,
                position: 'top-right',
                direction: 'ltr',
                timer: 4000
            });
        }

        function getCookie(name) {
            const match = document.cookie.match(new RegExp('(^| )' + name + '=([^;]+)'));
            if (match) {
                return decodeURIComponent(match[2]);
            }
            return null;
        }


        document.addEventListener('DOMContentLoaded', function () {
            const ratingContainers = document.querySelectorAll('.product__details__rating');

            ratingContainers.forEach(container => {
                const ratingValue = parseFloat(container.getAttribute('data-value'));
                displayStarRating(ratingValue, container);
            });

            function displayStarRating(numStars, container) {
                container.innerHTML = '';

                for (let i = 1; i <= 5; i++) {
                    const star = document.createElement('i');
                    star.classList.add('fa', i <= numStars ? 'fa-star' : 'fa-star-o');

                    if (i === Math.ceil(numStars) && numStars % 1 !== 0) {
                        star.classList.add('fa-star-half-o');
                    }

                    container.appendChild(star);
                }
            }
        });

        function uploadStarNumber() {
            const ratingContainers = document.querySelectorAll('.product__details__rating');

            ratingContainers.forEach(container => {
                const ratingValue = parseFloat(container.getAttribute('data-value'));
                displayStarRating(ratingValue, container);
            });

            function displayStarRating(numStars, container) {
                container.innerHTML = '';

                for (let i = 1; i <= 5; i++) {
                    const star = document.createElement('i');
                    star.classList.add('fa', i <= numStars ? 'fa-star' : 'fa-star-o');

                    if (i === Math.ceil(numStars) && numStars % 1 !== 0) {
                        star.classList.add('fa-star-half-o');
                    }

                    container.appendChild(star);
                }
            }
        }

        function updateDOMWithRatings() {
            var ratingsContainer = $("#ratingsContainer");
            ratingsContainer.empty(); // Clear existing content

            var formData = $('#ratingForm').serialize();
            console.log(formData);

            var rating = formData.match(/rating=([^&]+)/)[1];
            var comment = decodeURIComponent(formData.match(/comment=([^&]+)/)[1]);

            console.log("Rating:", rating);
            console.log("Comment:", comment);

            // Use JavaScript variables directly in the template
            var newRatingHTML = `
                                <div class='media mb-4'>
                                    <img src='/img/profile.jpg' alt='Image' class='img-fluid mr-3 mt-1' style='width: 45px' />
                                    <div class='media-body'>
                                        <h6>{{customerName}}<small> - <i>${new Date().toLocaleString()}</i></small></h6>
                                        <div class='product__details__rating' data-value="${rating}}"></div>
                                        <p>${comment}</p>
                                    </div>
                                </div>`;

            ratingsContainer.append(newRatingHTML);
            uploadStarNumber()
        }



        function submitForm() {
            var formData = $('#ratingForm').serialize();
            $.ajax({
                type: 'POST',
                url: '/rating',
                data: formData,
                success: function (response) {
                    console.log(response);
                },
                error: function (error) {
                    console.error('Error:', error);
                }
            });
        }

    </script>
</body>

</html>